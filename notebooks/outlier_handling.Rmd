---
title: "R Notebook"
output: html_notebook
---

Useful Quote:

Outlier: “Observation which deviates so much from other observations as to arouse suspicion it was generated by a different mechanism.” Hawkins (1980)


```{r}
library(MazamaCoreUtils)
library(MazamaSpatialUtils)
library(AirSensor)
library(dplyr)

source("R/util.R")

```


The code below is used to update the sensor catalog, fetch the data, and generate a list of Purple Air time series data. I will then select one sensor from this list with which to perform an analysis. 

```{r}

setArchiveBaseUrl("http://smoke.mazamascience.com/data/PurpleAir")

fetch_SensorCatalog()
sensor_catalog <- load_SensorCatalog()

pas <- pas_load(retries = 7, archival = TRUE) 

pat_list <- get_pat_list(pas = pas, sensor_labels = sensor_catalog[['Sensor Label']])

```


Next we will select one sensor that downloaded successfully, and conduct put it through our outlier handling system.

In this example, we'll use the sensor EW_Waldorf_d72.

```{r}
pat_list[['EW_Waldorf_4a8']] %>% 
  pat_multiplot()
```


```{r}
pat_list[['EW_Waldorf_4a8']] %>% 
  pat_outliers(replace = TRUE, showPlot = TRUE)
```


```{r}
pat_list[['EW_Waldorf_4a8']] %>% 
  pat_internalFit()
```


```{r}
pat_list[['EW_Waldorf_4a8']] %>% 
  pat_externalFit()
```

